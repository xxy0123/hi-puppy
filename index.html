<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>hi~my puppy</title>
    <style>
        body { margin: 0; padding: 20px; display: flex; justify-content: center; align-items: center; height: 100vh; background-color: #fff0f5; font-family: sans-serif; text-align: center; color: #800080; }
        .content-container { display: none; animation: fadeIn 1.5s ease-in-out; }
        
        /* è®©æ•´ä¸ªåˆå§‹ç•Œé¢å˜æˆä¸€ä¸ªå¯çˆ±çš„ã€å¯ç‚¹å‡»çš„æŒ‰é’® */
        #reveal-button {
            display: flex;
            flex-direction: column; 
            align-items: center;
            cursor: pointer; /* é¼ æ ‡æ‚¬åœæ—¶æ˜¾ç¤ºå°æ‰‹ï¼Œæç¤ºç”¨æˆ·å¯ä»¥ç‚¹å‡» */
            border: 2px dashed #ffb6c1;
            padding: 30px;
            border-radius: 20px;
            transition: transform 0.2s ease, background-color 0.2s;
        }
        #reveal-button:hover {
            transform: scale(1.05); /* æ‚¬åœæ—¶æ”¾å¤§ä¸€ç‚¹ç‚¹ */
            background-color: rgba(255, 255, 255, 0.5);
        }
        #loading-text { font-size: 0.5em; }
        #loading-gif { width: 180px; height: 180px; margin-top: 15px; }

        .text-answer { font-size: 2.5em; font-weight: bold; }
        .image-answer { max-width: 90vw; max-height: 80vh; border-radius: 10px; box-shadow: 0 0 20px rgba(0,0,0,0.5); }
        .audio-answer { filter: invert(1); }
        @keyframes fadeIn { from { opacity: 0; transform: scale(0.9); } to { opacity: 1; transform: scale(1); } }
    </style>
</head>
<body>

<!-- å°†åŠ è½½å®¹å™¨å˜æˆä¸€ä¸ªæœ‰äº¤äº’çš„â€œå¼€å¯æƒŠå–œâ€æŒ‰é’® -->
<div id="reveal-button">
    <p id="loading-text">å®å®ğŸ¥°ï¼Œç‚¹è¿™é‡Œçœ‹çœ‹æœ‰ä»€ä¹ˆğŸ‘€</p>
    <!-- ä½¿ç”¨æ­£ç¡®çš„ç›¸å¯¹è·¯å¾„ -->
    <img id="loading-gif" src="loading.gif" alt="ç‚¹å‡»å¼€å¯">
</div>
    
<div id="text-container" class="content-container"><p id="text-answer" class="text-answer"></p></div>
<div id="image-container" class="content-container"><img id="image-answer" src="" alt="éšæœºå›¾ç‰‡" class="image-answer"></div>
<div id="audio-container" class="content-container"><audio id="audio-answer" controls autoplay class="audio-answer"></audio></div>

<script>
const GITHUB_REPO_API = "https://api.github.com/repos/xxy0123/hi-puppy";
const textData = [
    "æ˜¯æˆ‘çš„å°ç‹—ï¼", "å½“ç„¶æ˜¯å®å®ï¼", "æˆ‘æœ€çˆ±çš„å°ç‹—å‡ºç°å•¦ï¼", "æ˜¯å…¨ä¸–ç•Œæœ€å¯çˆ±çš„å®å®ï¼", "çŒœå¯¹å•¦ï¼Œå°±æ˜¯ä½ ï¼"
];

// --- ä¸‹æ–¹çš„ä»£ç å·²ä¸ºæ‚¨ä¼˜åŒ–å’Œä¿®å¤ï¼Œæ— éœ€ä¿®æ”¹ ---
let imageData = [];
let audioData = [];

async function fetchContents(path) {
    try {
        const response = await fetch(`${GITHUB_REPO_API}/contents/${path}`);
        if (!response.ok) throw new Error('Network response was not ok');
        const data = await response.json();
        return data.filter(item => item.type === 'file' && !item.name.includes('placeholder')).map(item => item.download_url);
    } catch (error) {
        console.error(`Failed to fetch ${path}:`, error); return [];
    }
}

async function initializeAndShow() {
    [imageData, audioData] = await Promise.all([fetchContents('images'), fetchContents('audios')]);
    
    setTimeout(() => {
        // --- æ ¸å¿ƒä¿®æ”¹ (3/3): ç°åœ¨åªéœ€éšè—æ•´ä¸ªå®¹å™¨ï¼Œæ›´æ•´æ´ ---
        document.getElementById('loading-container').style.display = 'none';
        showRandomContent();
    }, 2000); //2ç§’å»¶è¿Ÿ
}

function showRandomContent() {
    document.querySelectorAll('.content-container').forEach(c => c.style.display = 'none');
    
    const availableTypes = [];
    if (textData.length > 0) availableTypes.push('text');
    if (imageData.length > 0) availableTypes.push('image');
    if (audioData.length > 0) availableTypes.push('audio');
    
    if (availableTypes.length === 0) {
        // --- BUGä¿®å¤: å½“å†…å®¹ä¸ºç©ºæ—¶ï¼Œæ­£ç¡®æ˜¾ç¤ºæç¤ºä¿¡æ¯ ---
        const loadingText = document.getElementById('loading-text');
        loadingText.textContent = "å†…å®¹åº“ä¸ºç©ºï¼Œå¿«å»GitHubæ·»åŠ æ–‡ä»¶å§ï¼";
        document.getElementById('loading-gif').style.display = 'none'; // éšè—åŠ¨å›¾
        document.getElementById('loading-container').style.display = 'flex'; // é‡æ–°æ˜¾ç¤ºåŠ è½½å®¹å™¨ä»¥å±•ç¤ºæ–‡æœ¬
        return;
    }

    const randomType = availableTypes[Math.floor(Math.random() * availableTypes.length)];

    if (randomType === 'text') {
        const randomText = textData[Math.floor(Math.random() * textData.length)];
        document.getElementById('text-answer').textContent = randomText;
        document.getElementById('text-container').style.display = 'block';
    } else if (randomType === 'image') {
        const randomImage = imageData[Math.floor(Math.random() * imageData.length)];
        document.getElementById('image-answer').src = randomImage;
        document.getElementById('image-container').style.display = 'block';
    } else if (randomType === 'audio') {
        const randomAudio = audioData[Math.floor(Math.random() * audioData.length)];
        document.getElementById('audio-answer').src = randomAudio;
        document.getElementById('audio-container').style.display = 'block';
    }
}

window.onload = initializeAndShow;
</script>
</body>
</html>
